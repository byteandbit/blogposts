---
title: 'Magento - Zend Framework 1 Security Vulnerability'
published: true
date: '08:45 16-01-2017'
taxonomy:
    category:
        - blog
    tag:
        - 'Magento 2'
        - Magento
        - Security
        - Vulnerability
external_links:
    process: true
    title: false
    no_follow: true
    target: _blank
    mode: active
visible: true
---

![Magento - Zend Framework 1 Security Vulnerability](magento-header-zf1.jpg)

On Friday the 13th, Magento [announced](https://magento.com/security/news/new-zend-framework-1-security-vulnerability) a new vulnerability in the [Email Component](https://framework.zend.com/security/advisory/ZF2016-04) of Zend Framework 1 and 2, a component which is used by all Magento 1 and Magento 2 versions.

This vulnerability is serious and can lead to a remote code execution attack if your server uses Sendmail as a mail transport agent. The attack is performed by providing additional quote characters within an address. 
When unsanitized, they can be interpreted as additional command line arguments to the system sendmail program, leading to the vulnerability.

Magento is currently working to provide patches to close this vulnerability.
They also provide a quick solution to prevent your Shop from a possible attack, by checking your mail sending settings and disabling the "Set Return-Path".

**Magento 1:** 
```bash
System-> Configuration-> System-> Mail Sending Settings-> Set Return-Path
```

**Magento 2:** 
```bash
Stores-> Configuration-> Advanced-> System-> Mail Sending Settings-> Set Return-Path
```
**If “Set Return-Path” is set to “Yes,” and your server uses Sendmail, then your store is vulnerable to this exploit.**
As the risk is very high it's strongly recommended to turn off the “Set Return-Path” setting (switch to “No”), regardless of the transport agent used. 

## Update

[Ian Cassidy](https://twitter.com/iancassidyweb) demonstrates an easy way to check and set the Magento mail settings with [n98-magerun](https://github.com/netz98/n98-magerun) which is great if you have multiple clients.

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Check and set your <a href="https://twitter.com/hashtag/magento?src=hash">#magento</a> mail settings easily with <a href="https://twitter.com/hashtag/n98magerun?src=hash">#n98magerun</a> great for multiple clients <a href="https://t.co/2SqXdFJ6Nk">https://t.co/2SqXdFJ6Nk</a> <a href="https://twitter.com/hashtag/realmagento?src=hash">#realmagento</a> <a href="https://twitter.com/hashtag/magento2?src=hash">#magento2</a> <a href="https://t.co/aH5yittkri">pic.twitter.com/aH5yittkri</a></p>&mdash; Ian Cassidy (@iancassidyweb) <a href="https://twitter.com/iancassidyweb/status/820911658331684864">January 16, 2017</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

Get mail return path settings for Magento 1 & Magento 2
```bash
n98-magerun.phar config:get --scope="default" --scope-id="0" system/smtp/set_return_path
```

Set mail return path settings for Magento 1 & Magento 2
```bash
n98-magerun.phar config:set --scope="default" --scope-id="0" system/smtp/set_return_path 0
```